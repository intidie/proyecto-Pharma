<script>
  document.querySelectorAll('form').forEach((form, index) => {
    const tipos = ['TOC', 'pH', 'Conductividad'];
    const tipo = tipos[index];

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const formData = new FormData(form);
      const data = {
        tipo: tipo,
        fecha: formData.get('fecha'),
        dato: formData.get('dato'),
        pu: formData.get('pu')
      };

      const response = await fetch('/guardar', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      const result = await response.json();
      if (response.ok) {
        alert(result.mensaje);
        form.reset(); // Limpiar el formulario
      } else {
        alert('Error: ' + (result.error || 'No se pudo guardar'));
      }
    });
  });

  // PestaÃ±as (sin cambios)
  function showSection(section) {
    document.getElementById('section-microbiologia').classList.add('hidden');
    document.getElementById('section-fisicoquimica').classList.add('hidden');
    document.getElementById('section-' + section).classList.remove('hidden');

    ['micro', 'fisico'].forEach(btn => {
      const el = document.getElementById('tab-' + btn);
      el.classList.remove('bg-' + (btn === 'micro' ? 'micro' : 'fisico'), 'text-white');
      el.classList.add('bg-' + (btn === 'micro' ? 'micro/10' : 'fisico/10'), 'text-' + (btn === 'micro' ? 'micro' : 'fisico'));
    });

    const active = section === 'microbiologia' ? 'micro' : 'fisico';
    document.getElementById('tab-' + active).classList.remove('bg-' + (active === 'micro' ? 'micro/10' : 'fisico/10'), 'text-' + (active === 'micro' ? 'micro' : 'fisico'));
    document.getElementById('tab-' + active).classList.add('bg-' + (active === 'micro' ? 'micro' : 'fisico'), 'text-white');
  }

  window.onload = () => showSection('fisicoquimica');
</script>